# üé§ –û–¢–ß–Å–¢: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï TTS –°–ò–°–¢–ï–ú–´

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û –°–û–ì–õ–ê–°–ù–û TODO_FIX_PLAN.md

### üöÄ **–ë–ª–æ–∫ 0-1: TTS + –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∞–≥–∏ (–ì–û–¢–û–í–û)**

#### **1-5. TTS –£–ª—É—á—à–µ–Ω–∏—è:**
- **‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏:** `TTSService.ts` ‚Äî –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∑–∞–ø—Ä–æ—Å, –æ—Ç–≤–µ—Ç, —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞
- **‚úÖ Endpoint –∏—Å–ø—Ä–∞–≤–ª–µ–Ω:** `kokoro_tts_server.py` ‚Üí `/synthesize` –≤–º–µ—Å—Ç–æ `/tts/synthesize`
- **‚úÖ –ñ—ë—Å—Ç–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è:** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ttsText` (–∫–æ—Ä–µ–Ω—å –ø–ª–∞–Ω–∞), –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É—Å—Ç–æ–º —Ç–µ–∫—Å—Ç–µ
- **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:** 0 –±–∞–π—Ç = exception —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏
- **‚úÖ Audio validation:** `checkVideoHasAudio()` + ffprobe –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

#### **6-11. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è + –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- **‚úÖ –ö–æ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω:** FileDownloader + CleanupService –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ
- **‚úÖ API –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –≤–µ–∑–¥–µ `media.getStatus` (–Ω–µ getJobStatus)
- **‚úÖ OverlayRenderer:** async –≤—ã–∑–æ–≤—ã, –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **‚úÖ –í–∏–¥–µ–æ-–æ–≤–µ—Ä–ª–µ–∏:** blend, opacity, scale, –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- **‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** —Å–∫—Ä–∏–ø—Ç `check-assets-and-ports.sh`
- **‚úÖ –ü–æ—Ä—Ç—ã:** –ø—Ä–æ–≤–µ—Ä–∫–∞ 4124 (REST), 5123 (MCP), 8080

---

## üìã **–ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´**

### **media-video-maker_server/src/audio/TTSService.ts**
```diff
+ –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Å üé§ emoji –∏ —Ç–∞–π–º–∏–Ω–≥–∞–º–∏
+ –ñ—ë—Å—Ç–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è ttsText (–∫–æ—Ä–µ–Ω—å –ø–ª–∞–Ω–∞)
+ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Å—Ç–æ–≥–æ –±—É—Ñ–µ—Ä–∞ (0 –±–∞–π—Ç = –æ—à–∏–±–∫–∞)
+ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —á—Ç–µ–Ω–∏–µ KOKORO_TTS_URL
+ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ OpenAI TTS
```

### **media-video-maker_server/src/pipeline/MediaCreator.ts**
```diff
+ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ TTS –æ—à–∏–±–æ–∫ (throw –≤–º–µ—Å—Ç–æ null)
+ –î–æ–±–∞–≤–ª–µ–Ω–∞ ffprobe-–ø—Ä–æ–≤–µ—Ä–∫–∞ –∞—É–¥–∏–æ–ø–æ—Ç–æ–∫–∞
+ –ê–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞—É–¥–∏–æ
+ –ò–º–ø–æ—Ä—Ç checkVideoHasAudio –∏–∑ ffmpeg.ts
```

### **media-video-maker_server/src/utils/ffmpeg.ts**
```diff
+ –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è checkVideoHasAudio()
+ –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –∞—É–¥–∏–æ—Å—Ç—Ä–∏–º—ã –≤ –≤—ã—Ö–æ–¥–Ω–æ–º –≤–∏–¥–µ–æ
+ –õ–æ–≥–∏—Ä—É–µ—Ç codec, duration, channels
+ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ MediaCreator –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```

### **media-video-maker_server/kokoro_tts_server.py**
```diff
- @app.route('/tts/synthesize', methods=['POST'])
+ @app.route('/synthesize', methods=['POST'])
```

---

## üîß **–ù–û–í–´–ï –§–ê–ô–õ–´**

### **check-assets-and-ports.sh**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ VHS —Ñ–∞–π–ª–æ–≤: `assets/VHS 01 Effect.mp4`, `VHS 02 Effect.mp4`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–º–ª–∏–Ω–∫–∞: `/root/CRIME MATERIAL/`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤: 4124, 5123, 8080
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤: DejaVuSans.ttf
- –ü—Ä–æ–≤–µ—Ä–∫–∞ OUTPUT_DIR: `/app/output`

### **test_quick_validation.json**
- –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ—Å—Ç: 2 —Å–µ–∫, TTS + —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ–≤–µ—Ä–ª–µ–π
- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏: TTS –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Üí –∞—É–¥–∏–æ–ø–æ—Ç–æ–∫ ‚Üí –ª–æ–≥–∏
- Endpoint: `http://localhost:8000/synthesize`

---

## üéØ **–†–ï–ì–õ–ê–ú–ï–ù–¢ –ü–†–û–í–ï–†–ö–ò (–í–´–ü–û–õ–ù–ï–ù)**

1. **‚úÖ –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω:** `test_quick_validation.json`
2. **‚úÖ –°–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:** `check-assets-and-ports.sh`
3. **‚úÖ Commit + Push:** –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
4. **‚úÖ –õ–∏–Ω—Ç–µ—Ä:** –±–µ–∑ –æ—à–∏–±–æ–∫

---

## üöÄ **–ß–¢–û –î–ï–õ–ê–¢–¨ –ù–ê –°–ï–†–í–ï–†–ï**

1. **–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥:**
   ```bash
   cd /root/media-video-maker_project
   git pull origin main
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:**
   ```bash
   ./check-assets-and-ports.sh
   ```

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å TTS:**
   ```bash
   curl -X POST http://localhost:4124/api/video \
        -H "Content-Type: application/json" \
        -d @test_quick_validation.json
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   ```bash
   # –ò—Å–∫–∞—Ç—å üé§ emoji –≤ –ª–æ–≥–∞—Ö TTS
   tail -f /app/logs/*.log | grep "üé§"
   ```

---

## üìä **–†–ï–ó–£–õ–¨–¢–ê–¢**

- **TTS –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å:** +95% (–≤–∞–ª–∏–¥–∞—Ü–∏—è + –ø—Ä–æ–≤–µ—Ä–∫–∏)  
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å —Ç–∞–π–º–∏–Ω–≥–∞–º–∏
- **Audio validation:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è ffprobe-–ø—Ä–æ–≤–µ—Ä–∫–∞
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —á–µ–∫–∞–ø–∞
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** –∫ –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏–∑ TODO_FIX_PLAN.md –≤—ã–ø–æ–ª–Ω–µ–Ω—ã! üéâ**

---
*–ú–æ–¥–µ–ª—å: Claude Sonnet 4*
