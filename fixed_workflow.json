{
  "name": "üé¨ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –í–∏–¥–µ–æ (AI Agent)",
  "nodes": [
    {
      "parameters": {},
      "id": "manual-trigger",
      "name": "üöÄ –ó–∞–ø—É—Å–∫",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [460, 300],
      "id": "ai-screenwriter-agent",
      "name": "üé≠ AI –°—Ü–µ–Ω–∞—Ä–∏—Å—Ç Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "anthropic/claude-3.5-sonnet",
          "cachedResultName": "Claude 3.5 Sonnet"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [460, 480],
      "id": "openrouter-chat-model",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "dctACn3yXSG7qIdH",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdExpression": "={{ $workflow.executionId }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [680, 480],
      "id": "simple-memory",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "jsCode": "// –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–º–ø—Ç –¥–ª—è AI –°—Ü–µ–Ω–∞—Ä–∏—Å—Ç–∞\nconst topic = $input.first().json.topic || '–∫—Ä–∏–º–∏–Ω–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è';\n\nconst prompt = `–¢—ã AI –°—Ü–µ–Ω–∞—Ä–∏—Å—Ç –¥–ª—è –∫—Ä–∏–º–∏–Ω–∞–ª—å–Ω—ã—Ö shorts –≤–∏–¥–µ–æ. –°–æ–∑–¥–∞–π –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π.\n\n–¢–µ–º–∞: ${topic}\n\n–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:\n- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 45-60 —Å–µ–∫—É–Ω–¥\n- 6-8 —Å—Ü–µ–Ω –ø–æ 6-10 —Å–µ–∫—É–Ω–¥ –∫–∞–∂–¥–∞—è\n- –ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π –∫—Ä—é–∫ –≤ –ø–µ—Ä–≤—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã\n- –ß–µ—Ç–∫–∏–µ —Ç–∞–π–º–∏–Ω–≥–∏\n- –û–ø–∏—Å–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∞ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ü–µ–Ω—ã\n- –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–æ—Ç–æ\n\n–í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ:\n{\n  \"title\": \"–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ\",\n  \"hook\": \"–ö—Ä—é–∫ –¥–ª—è –ø–µ—Ä–≤—ã—Ö 3 —Å–µ–∫—É–Ω–¥\",\n  \"duration\": 60,\n  \"scenes\": [\n    {\n      \"id\": 1,\n      \"duration\": 8,\n      \"voiceover\": \"–¢–µ–∫—Å—Ç –¥–ª—è –æ–∑–≤—É—á–∫–∏\",\n      \"subtitle\": \"–°—É–±—Ç–∏—Ç—Ä—ã\",\n      \"visual_description\": \"–û–ø–∏—Å–∞–Ω–∏–µ —á—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å\",\n      \"search_keywords\": [\"crime scene\", \"police\"],\n      \"mood\": \"dark\"\n    }\n  ],\n  \"total_voiceover\": \"–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –æ–∑–≤—É—á–∫–∏\",\n  \"music_style\": \"dark_ambient\"\n}`;\n\nreturn {\n  json: {\n    chatInput: prompt,\n    topic: topic\n  }\n};"
      },
      "id": "prepare-screenwriter-prompt",
      "name": "üìù –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ —Å—Ü–µ–Ω–∞—Ä–∏—Å—Ç–∞",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "jsCode": "// –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç –æ—Ç AI Agent\nconst response = $input.first().json.output;\nlet scenario;\n\ntry {\n  const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n  if (jsonMatch) {\n    scenario = JSON.parse(jsonMatch[0]);\n  } else {\n    throw new Error('JSON –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ');\n  }\n} catch (error) {\n  console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è:', error);\n  scenario = {\n    title: \"–ö—Ä–∏–º–∏–Ω–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è - –¢–µ—Å—Ç\",\n    duration: 60,\n    scenes: [\n      {\n        id: 1,\n        duration: 10,\n        voiceover: \"–í —Ç–µ–º–Ω–æ–º –ø–µ—Ä–µ—É–ª–∫–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ –∑–∞–≥–∞–¥–æ—á–Ω–æ–µ –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ\",\n        subtitle: \"–ó–∞–≥–∞–¥–æ—á–Ω–æ–µ –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ\",\n        visual_description: \"–¢–µ–º–Ω–∞—è —É–ª–∏—Ü–∞ —Å –ø–æ–ª–∏—Ü–µ–π—Å–∫–æ–π –ª–µ–Ω—Ç–æ–π\",\n        search_keywords: [\"crime scene\", \"police tape\", \"dark street\"]\n      },\n      {\n        id: 2,\n        duration: 10,\n        voiceover: \"–î–µ—Ç–µ–∫—Ç–∏–≤—ã –Ω–∞—á–∞–ª–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –¥–µ–ª–∞\",\n        subtitle: \"–ù–∞—á–∞–ª–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è\",\n        visual_description: \"–î–µ—Ç–µ–∫—Ç–∏–≤—ã –∏–∑—É—á–∞—é—Ç —É–ª–∏–∫–∏\",\n        search_keywords: [\"detective\", \"investigation\", \"evidence\"]\n      },\n      {\n        id: 3,\n        duration: 10,\n        voiceover: \"–ö–∞–∂–¥–∞—è –∂–µ—Ä—Ç–≤–∞ –∏–º–µ–ª–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–∏–º–≤–æ–ª\",\n        subtitle: \"–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∏–º–≤–æ–ª\",\n        visual_description: \"–î—Ä–µ–≤–Ω–∏–π —Å–∏–º–≤–æ–ª –Ω–∞ –∫–æ–∂–µ –∂–µ—Ä—Ç–≤—ã\",\n        search_keywords: [\"symbol\", \"victim\", \"mystery\"]\n      },\n      {\n        id: 4,\n        duration: 10,\n        voiceover: \"–†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–µ–ª–æ –∫ —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–∞–Ω–∏–∏\",\n        subtitle: \"–û–ø–∞—Å–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è\",\n        visual_description: \"–ó–¥–∞–Ω–∏–µ —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–∞–Ω–∏–∏\",\n        search_keywords: [\"pharmaceutical\", \"company\", \"building\"]\n      },\n      {\n        id: 5,\n        duration: 10,\n        voiceover: \"–î–µ—Ç–µ–∫—Ç–∏–≤ –ú–∞—Ä—Ç–∏–Ω–µ—Å –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞\",\n        subtitle: \"–ü—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞\",\n        visual_description: \"–î—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è–Ω–∏–µ\",\n        search_keywords: [\"betrayal\", \"partner\", \"confrontation\"]\n      },\n      {\n        id: 6,\n        duration: 10,\n        voiceover: \"–ü—Ä–∞–≤–¥–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å –±–æ–ª–µ–µ —É–∂–∞—Å–∞—é—â–µ–π —á–µ–º –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å\",\n        subtitle: \"–£–∂–∞—Å–∞—é—â–∞—è –ø—Ä–∞–≤–¥–∞\",\n        visual_description: \"–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ\",\n        search_keywords: [\"truth\", \"revelation\", \"shocking\"]\n      }\n    ],\n    total_voiceover: \"–í —Ç–µ–º–Ω–æ–º –ø–µ—Ä–µ—É–ª–∫–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ –∑–∞–≥–∞–¥–æ—á–Ω–æ–µ –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ. –î–µ—Ç–µ–∫—Ç–∏–≤—ã –Ω–∞—á–∞–ª–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –¥–µ–ª–∞. –ö–∞–∂–¥–∞—è –∂–µ—Ä—Ç–≤–∞ –∏–º–µ–ª–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–∏–º–≤–æ–ª. –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–µ–ª–æ –∫ —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–∞–Ω–∏–∏. –î–µ—Ç–µ–∫—Ç–∏–≤ –ú–∞—Ä—Ç–∏–Ω–µ—Å –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞. –ü—Ä–∞–≤–¥–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å –±–æ–ª–µ–µ —É–∂–∞—Å–∞—é—â–µ–π —á–µ–º –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å.\",\n    music_style: \"dark_ambient\"\n  };\n}\n\nreturn {\n  json: {\n    scenario: scenario,\n    topic: $('üìù –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ —Å—Ü–µ–Ω–∞—Ä–∏—Å—Ç–∞').first().json.topic\n  }\n};"
      },
      "id": "parse-scenario",
      "name": "üìã –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ü–µ–Ω–∞—Ä–∏—è",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 300]
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "1R8DSsDKqGBaBvI4D1T_L1AM9vHz0Y-Yq",
            "mode": "list",
            "cachedResultName": "Baza-n8n"
          }
        },
        "options": {}
      },
      "id": "google-drive-search",
      "name": "üìÅ AI –†–µ–∂–∏—Å—Å–µ—Ä - –ü–æ–∏—Å–∫ –≤ Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [1120, 300],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "XDM9FIbDJMpu7nGH",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.id }}"
        },
        "options": {}
      },
      "id": "download-images",
      "name": "‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [1340, 300],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "XDM9FIbDJMpu7nGH",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const fs = require('fs');\nconst path = require('path');\n\nconst executionId = $workflow.executionId;\nconst tempDir = `/tmp/n8n_video_${executionId}`;\n\nif (!fs.existsSync(tempDir)) {\n  fs.mkdirSync(tempDir, { recursive: true });\n}\n\nconst allItems = $input.all();\nconst scenario = $('üìã –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ü–µ–Ω–∞—Ä–∏—è').first().json.scenario;\n\nconsole.log('–í—Å–µ–≥–æ —Å–∫–∞—á–∞–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:', allItems.length);\nconst validItems = allItems.filter(item => item.binary && item.binary.data);\nconsole.log('–≠–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏:', validItems.length);\n\n// –ë–µ—Ä–µ–º –¥–æ 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π\nconst imageItems = validItems.slice(0, 10);\nlet savedCount = 0;\n\nfor (let i = 0; i < imageItems.length; i++) {\n  const item = imageItems[i];\n  const filename = `img${String(i + 1).padStart(3, '0')}.jpg`;\n  const filepath = path.join(tempDir, filename);\n  \n  try {\n    const buffer = Buffer.from(item.binary.data.data, 'base64');\n    fs.writeFileSync(filepath, buffer);\n    savedCount++;\n    console.log(`–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: ${filename}`);\n  } catch (err) {\n    console.log('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', filename, err.message);\n  }\n}\n\nconsole.log(`–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ${savedCount} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`);\n\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Ñ–æ—Ç–æ\nconst requiredImages = scenario.scenes ? scenario.scenes.length : 6;\nconst needMoreImages = savedCount < requiredImages;\n\nreturn {\n  json: {\n    tempDir: tempDir,\n    savedImages: savedCount,\n    requiredImages: requiredImages,\n    needMoreImages: needMoreImages,\n    scenario: scenario,\n    executionId: executionId\n  }\n};"
      },
      "id": "save-and-analyze",
      "name": "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1560, 300]
    },
    {
      "parameters": {
        "jsCode": "// AI –ü—Ä–æ–¥—é—Å–µ—Ä - —Å–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –∏ —Å–æ–∑–¥–∞–µ–º JSON –¥–ª—è MCP\nconst scenario = $('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ').first().json.scenario;\nconst tempDir = $('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ').first().json.tempDir;\nconst savedImages = $('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ').first().json.savedImages;\n\n// –§–æ—Ä–º–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –¥–ª—è MCP\nconst files = [];\nconst scenes = scenario.scenes || [];\n\n// –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\nfor (let i = 0; i < Math.min(scenes.length, savedImages); i++) {\n  const scene = scenes[i];\n  files.push({\n    id: `scene_${i + 1}`,\n    src: `${tempDir}/img${String(i + 1).padStart(3, '0')}.jpg`,\n    type: \"photo\",\n    durationSec: scene.duration || 10\n  });\n}\n\n// –ï—Å–ª–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –¥—É–±–ª–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ\nwhile (files.length < scenes.length) {\n  const lastFile = files[files.length - 1];\n  if (lastFile) {\n    files.push({\n      id: `scene_${files.length + 1}`,\n      src: lastFile.src,\n      type: \"photo\",\n      durationSec: scenes[files.length].duration || 10\n    });\n  } else {\n    break;\n  }\n}\n\n// –°–æ–∑–¥–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π JSON –¥–ª—è MCP\nconst mcpPayload = {\n  files: files,\n  width: 1080,\n  height: 1920,\n  fps: 30,\n  outputFormat: \"mp4\",\n  tts: {\n    provider: \"kokoro\",\n    voice: \"default\"\n  },\n  ttsText: scenario.total_voiceover || \"–¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç –æ–∑–≤—É—á–∫–∏\",\n  subtitles: scenes.map((scene, index) => ({\n    start: scenes.slice(0, index).reduce((sum, s) => sum + (s.duration || 10), 0),\n    end: scenes.slice(0, index + 1).reduce((sum, s) => sum + (s.duration || 10), 0),\n    text: scene.subtitle || scene.voiceover || `–°—Ü–µ–Ω–∞ ${index + 1}`\n  })),\n  burnSubtitles: true,\n  effects: [\n    {\n      kind: \"zoom\",\n      params: {\n        startScale: 1.0,\n        endScale: 1.3\n      }\n    }\n  ],\n  overlays: []\n};\n\nconsole.log('MCP Payload —Å–æ–∑–¥–∞–Ω:', JSON.stringify(mcpPayload, null, 2));\n\nreturn {\n  json: {\n    mcp_payload: mcpPayload,\n    scenario: scenario,\n    tempDir: tempDir,\n    timestamp: new Date().toISOString()\n  }\n};"
      },
      "id": "ai-producer",
      "name": "üé≠ AI –ü—Ä–æ–¥—é—Å–µ—Ä - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ MCP",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1780, 300]
    },
    {
      "parameters": {
        "url": "http://178.156.142.35:4123/api/create-video",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "contentType": "json",
        "jsonBody": "={{ JSON.stringify($json.mcp_payload) }}",
        "options": {}
      },
      "id": "mcp-video-creation",
      "name": "üé¨ MCP –ú–æ–Ω—Ç–∞–∂–µ—Ä",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2000, 300]
    },
    {
      "parameters": {
        "jsCode": "// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç MCP —Å–µ—Ä–≤–µ—Ä–∞\nconst mcpResponse = $input.first().json;\n\nconsole.log('MCP Response:', JSON.stringify(mcpResponse, null, 2));\n\nif (mcpResponse.id) {\n  return {\n    json: {\n      status: 'video_creation_started',\n      job_id: mcpResponse.id,\n      progress: 0,\n      message: `üé¨ –í–∏–¥–µ–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è! ID –∑–∞–¥–∞—á–∏: ${mcpResponse.id}`,\n      status_url: `http://178.156.142.35:4123/api/status/${mcpResponse.id}`,\n      scenario: $('üé≠ AI –ü—Ä–æ–¥—é—Å–µ—Ä - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ MCP').first().json.scenario\n    }\n  };\n} else {\n  return {\n    json: {\n      status: 'error',\n      message: '‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏–¥–µ–æ',\n      error: mcpResponse.error || mcpResponse.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞',\n      full_response: mcpResponse\n    }\n  };\n}"
      },
      "id": "process-mcp-response",
      "name": "üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ MCP",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2220, 300]
    },
    {
      "parameters": {
        "url": "={{ $json.status_url }}",
        "options": {}
      },
      "id": "check-video-status",
      "name": "‚è±Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤–∏–¥–µ–æ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2440, 300]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "video-completed",
              "leftValue": "={{ $json.state }}",
              "rightValue": "done",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "check-completion",
      "name": "‚úÖ –í–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [2660, 300]
    },
    {
      "parameters": {
        "amount": 15,
        "unit": "seconds"
      },
      "id": "wait-for-completion",
      "name": "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [2440, 500]
    },
    {
      "parameters": {
        "operation": "upload",
        "name": "={{ $('üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ MCP').first().json.scenario.title || 'N8N Generated Video' }}.mp4",
        "parents": [
          "1LQGVzRshQLgKbLFZT-D2arfDEwGkLC-T"
        ],
        "options": {
          "description": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ N8N workflow —Å AI –∞–≥–µ–Ω—Ç–∞–º–∏"
        }
      },
      "id": "upload-to-gdrive",
      "name": "üì§ AI –ü—É–±–ª–∏–∫–∞—Ç–æ—Ä - –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [2880, 200],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "XDM9FIbDJMpu7nGH",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç\nconst videoData = $input.first().json;\nconst scenario = $('üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ MCP').first().json.scenario;\n\nconsole.log('–§–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ:', JSON.stringify(videoData, null, 2));\n\nreturn {\n  json: {\n    status: 'completed',\n    message: 'üéâ –í–∏–¥–µ–æ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ –∏ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –Ω–∞ Google Drive!',\n    title: scenario.title,\n    video_url: videoData.output || videoData.output_url,\n    gdrive_url: videoData.webViewLink,\n    gdrive_id: videoData.id,\n    duration: scenario.duration,\n    created_at: new Date().toISOString(),\n    workflow_success: true\n  }\n};"
      },
      "id": "final-result",
      "name": "üéâ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [3100, 300]
    }
  ],
  "connections": {
    "üöÄ –ó–∞–ø—É—Å–∫": {
      "main": [
        [
          {
            "node": "üìù –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ —Å—Ü–µ–Ω–∞—Ä–∏—Å—Ç–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìù –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ —Å—Ü–µ–Ω–∞—Ä–∏—Å—Ç–∞": {
      "main": [
        [
          {
            "node": "üé≠ AI –°—Ü–µ–Ω–∞—Ä–∏—Å—Ç Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üé≠ AI –°—Ü–µ–Ω–∞—Ä–∏—Å—Ç Agent": {
      "ai_languageModel": [
        [
          {
            "node": "OpenRouter Chat Model",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ],
      "ai_memory": [
        [
          {
            "node": "Simple Memory",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ],
      "main": [
        [
          {
            "node": "üìã –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ü–µ–Ω–∞—Ä–∏—è",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìã –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ü–µ–Ω–∞—Ä–∏—è": {
      "main": [
        [
          {
            "node": "üìÅ AI –†–µ–∂–∏—Å—Å–µ—Ä - –ü–æ–∏—Å–∫ –≤ Google Drive",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìÅ AI –†–µ–∂–∏—Å—Å–µ—Ä - –ü–æ–∏—Å–∫ –≤ Google Drive": {
      "main": [
        [
          {
            "node": "‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ": {
      "main": [
        [
          {
            "node": "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ": {
      "main": [
        [
          {
            "node": "üé≠ AI –ü—Ä–æ–¥—é—Å–µ—Ä - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ MCP",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üé≠ AI –ü—Ä–æ–¥—é—Å–µ—Ä - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ MCP": {
      "main": [
        [
          {
            "node": "üé¨ MCP –ú–æ–Ω—Ç–∞–∂–µ—Ä",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üé¨ MCP –ú–æ–Ω—Ç–∞–∂–µ—Ä": {
      "main": [
        [
          {
            "node": "üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ MCP",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ MCP": {
      "main": [
        [
          {
            "node": "‚è±Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤–∏–¥–µ–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚è±Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤–∏–¥–µ–æ": {
      "main": [
        [
          {
            "node": "‚úÖ –í–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚úÖ –í–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ?": {
      "main": [
        [
          {
            "node": "üì§ AI –ü—É–±–ª–∏–∫–∞—Ç–æ—Ä - –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Google Drive",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è": {
      "main": [
        [
          {
            "node": "‚è±Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤–∏–¥–µ–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì§ AI –ü—É–±–ª–∏–∫–∞—Ç–æ—Ä - –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Google Drive": {
      "main": [
        [
          {
            "node": "üéâ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "versionId": "C9RkDgm7BK2Z7dxt",
  "meta": {
    "templateCredsSetupCompleted": true
  }
}

