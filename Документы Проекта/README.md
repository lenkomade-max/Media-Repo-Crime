# Media Video Maker

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏–¥–µ–æ —Å MCP –∏ REST API.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd media-video-maker_server
npm install
```

### 2. –°–∫–∞—á–∞—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ñ–∞–π–ª—ã
**–í–ê–ñ–ù–û:** –°–∫–∞—á–∞–π—Ç–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ñ–∞–π–ª—ã:
- `kokoro-v1.0.onnx` (310MB) - –º–æ–¥–µ–ª—å TTS Kokoro
- `voices-v1.0.bin` - –≤–µ—Å–∞ –¥–ª—è Kokoro TTS

–ü–æ–º–µ—Å—Ç–∏—Ç–µ –∏—Ö –≤ –ø–∞–ø–∫—É `media-video-maker_server/`

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run dev

# –ü—Ä–æ–¥–∞–∫—à–Ω
npm run build
npm start
```

## üì° API Endpoints

### REST API (–ø–æ—Ä—Ç 4123)
- `GET /api/ping` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
- `POST /api/create-video` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ
- `GET /api/status/:id` - —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏
- `GET /api/jobs` - —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
- `GET /api/capabilities` - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞

### MCP Server (–ø–æ—Ä—Ç 5123)
- `POST /mcp/tools/media-video` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ MCP
- `POST /mcp/subtitles/generate` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤
- `POST /mcp/tts/synthesize` - —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏
- `POST /mcp/assets/probe` - –∞–Ω–∞–ª–∏–∑ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤

## üé¨ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ

### –ü—Ä–∏–º–µ—Ä JSON –ø–ª–∞–Ω–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã):
```json
{
  "files": [
    {
      "id": "img1",
      "src": "path/to/image.jpg",
      "type": "image"
    }
  ],
  "width": 1080,
  "height": 1920,
  "fps": 30,
  "durationPerPhoto": 2.0,
  "music": "path/to/music.mp3",
  "tts": {
    "provider": "kokoro",
    "text": "–¢–µ–∫—Å—Ç –¥–ª—è –æ–∑–≤—É—á–∫–∏"
  },
  "transcribeAudio": true,
  "burnSubtitles": true,
  "overlays": [
    {
      "type": "text",
      "text": "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
      "position": "top-center",
      "start": 0,
      "end": 5
    }
  ],
  "effects": [
    {
      "kind": "zoom",
      "params": {
        "startScale": 1.0,
        "endScale": 1.2
      }
    }
  ]
}
```

### –ü—Ä–∏–º–µ—Ä JSON –ø–ª–∞–Ω–∞ (–≤–Ω–µ—à–Ω–∏–µ URL):
```json
{
  "files": [
    {
      "id": "img1",
      "src": "https://picsum.photos/800/600",
      "type": "image",
      "download": true
    },
    {
      "id": "vid1",
      "src": "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
      "type": "video",
      "download": true
    }
  ],
  "width": 1080,
  "height": 1920,
  "fps": 30,
  "durationPerPhoto": 2.0,
  "music": "https://file-examples.com/storage/fe68c0b5b5b5b5b5b5b5b5b/2017/11/file_example_MP3_700KB.mp3",
  "musicDownload": true,
  "tts": {
    "provider": "none",
    "download": true
  },
  "voiceFile": "https://www.soundjay.com/misc/sounds/bell-ringing-05.wav",
  "transcribeAudio": true,
  "burnSubtitles": true,
  "overlays": [
    {
      "type": "text",
      "text": "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
      "position": "top-center",
      "start": 0,
      "end": 5
    }
  ],
  "effects": [
    {
      "kind": "zoom",
      "params": {
        "startScale": 1.0,
        "endScale": 1.2
      }
    }
  ]
}
```

## üõ† –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏
- ‚úÖ TTS –æ–∑–≤—É—á–∫–∞ (Kokoro, OpenAI)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—É–±—Ç–∏—Ç—Ä—ã (Whisper)
- ‚úÖ –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ–≤–µ—Ä–ª–µ–∏
- ‚úÖ –í–∏–¥–µ–æ —ç—Ñ—Ñ–µ–∫—Ç—ã (zoom, VHS, retro)
- ‚úÖ –ê—É–¥–∏–æ –º–∏–∫—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å ducking
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 4K —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ FFmpeg —Ñ–∏–ª—å—Ç—Ä—ã
- ‚úÖ **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø–æ URL** (FileDownloader)
- ‚úÖ **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —Å–∫–∞—á–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤** (CleanupService)
- ‚úÖ **Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –¥–ª—è n8n/–≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
media-video-maker_server/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ audio/          # TTS –∏ –∞—É–¥–∏–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ pipeline/       # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω –≤–∏–¥–µ–æ
‚îÇ   ‚îú‚îÄ‚îÄ server/         # REST –∏ MCP —Å–µ—Ä–≤–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ subtitles/      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ transcribe/     # Whisper —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ utils/          # –£—Ç–∏–ª–∏—Ç—ã (FileDownloader, CleanupService)
‚îú‚îÄ‚îÄ assets/             # –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ downloads/      # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–∞—á–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞)
‚îú‚îÄ‚îÄ out/               # –ì–æ—Ç–æ–≤—ã–µ –≤–∏–¥–µ–æ
‚îî‚îÄ‚îÄ dist/              # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
```

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- FFmpeg
- Python 3.8+ (–¥–ª—è Whisper)
- 4GB+ RAM
- 10GB+ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –ø–æ URL)

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "kokoro-v1.0.onnx not found"
–°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª –º–æ–¥–µ–ª–∏ –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ `media-video-maker_server/`

### –û—à–∏–±–∫–∞ FFmpeg
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ FFmpeg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `ffmpeg -version`

### –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç
–ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤ `src/index.ts` (REST: 4123, MCP: 5123)

### –û—à–∏–±–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å URL: `curl -I "https://example.com/file.jpg"`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ URL –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π MIME-—Ç–∏–ø
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–ª–∏–º–∏—Ç—ã: —Ñ–æ—Ç–æ 50MB, –≤–∏–¥–µ–æ 500MB, –∞—É–¥–∏–æ 100MB)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–µ `assets/downloads/`

### –ü—Ä–æ–±–ª–µ–º—ã –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ `assets/downloads/`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ webhook endpoint –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏ –æ—á–∏—Å—Ç–∫–∏

## üìù –õ–æ–≥–∏

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- `server.log` - –æ–±—â–∏–µ –ª–æ–≥–∏
- `api_server.log` - REST API
- `job_*/` - –ª–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á
- `assets/downloads/` - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–∞—á–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞)

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –≤–∏–¥–µ–æ (–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã):
```bash
curl -X POST http://localhost:4123/api/create-video \
  -H "Content-Type: application/json" \
  -d @example_plan.json
```

### –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ —Å –≤–Ω–µ—à–Ω–∏–º–∏ URL:
```bash
curl -X POST http://localhost:4123/api/create-video \
  -H "Content-Type: application/json" \
  -d '{
    "files": [
      {"id": "img1", "src": "https://picsum.photos/800/600", "type": "image", "download": true}
    ],
    "music": "https://file-examples.com/storage/fe68c0b5b5b5b5b5b5b5b5b/2017/11/file_example_MP3_700KB.mp3",
    "musicDownload": true,
    "width": 1080,
    "height": 1920,
    "durationPerPhoto": 2.0
  }'
```

### –ß–µ—Ä–µ–∑ MCP:
```bash
curl -X POST http://localhost:5123/mcp/tools/media-video \
  -H "Content-Type: application/json" \
  -d @mcp_plan.json
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
2. FFmpeg —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –ü–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã
4. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
5. –ú–æ–¥–µ–ª–∏ TTS —Å–∫–∞—á–∞–Ω—ã
6. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
7. URL —Ñ–∞–π–ª–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ MIME-—Ç–∏–ø—ã
8. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–µ `assets/downloads/`

---
**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
