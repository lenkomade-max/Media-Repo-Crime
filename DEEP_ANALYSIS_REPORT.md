# üîç –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –°–ò–°–¢–ï–ú–´ Media Video Maker

**–î–∞—Ç–∞:** 2025-10-02  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** Claude Sonnet 4 –æ—Ç Anthropic  
**–°—Ç–∞—Ç—É—Å:** –ó–ê–í–ï–†–®–ï–ù ‚úÖ

---

## üìã –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –≠–¢–ê–ü–´ –ê–ù–ê–õ–ò–ó–ê

### ‚úÖ **–≠—Ç–∞–ø 1: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** 
- –ü—Ä–æ—á–∏—Ç–∞–Ω PROJECT_MANIFEST_V2.md
- –ü—Ä–æ—á–∏—Ç–∞–Ω QUICK_START.md
- –ü–æ–Ω—è—Ç–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Node.js + TypeScript + FFmpeg + MCP

### ‚úÖ **–≠—Ç–∞–ø 2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- Backend (Node.js + TypeScript, Express)
- FFmpeg –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ
- TTS: Kokoro + OpenAI  
- MCP Server –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
- FileDownloader –¥–ª—è URL —Ñ–∞–π–ª–æ–≤
- CleanupService –¥–ª—è –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∏

### ‚úÖ **–≠—Ç–∞–ø 3: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞**
- `/media-video-maker_server/src/` ‚Äî –∏—Å—Ö–æ–¥–Ω–∏–∫–∏
- `/dist/` ‚Äî —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript
- –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å: `MediaCreator.ts`

### ‚úÖ **–≠—Ç–∞–ø 4: API Endpoints**
- `POST /api/create-video` ‚Äî —Å–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ ‚úÖ
- `GET /api/status/:id` ‚Äî —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ ‚úÖ  
- `POST /mcp/tools/media-video` ‚Äî MCP —Å–æ–∑–¥–∞–Ω–∏–µ ‚úÖ

### ‚úÖ **–≠—Ç–∞–ø 5: Video Pipeline**
- Photo/Video ‚Üí –°–ª–∞–π–¥—à–æ—É (`buildSlidesVideo`) ‚úÖ
- –ê—É–¥–∏–æ –º–∏–∫—à–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ
- –≠—Ñ—Ñ–µ–∫—Ç—ã –∏ –æ–≤–µ—Ä–ª–µ–∏ ‚ö†Ô∏è
- –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ ‚ùå

### ‚úÖ **–≠—Ç–∞–ø 6: Audio System**
- Music: –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É ‚úÖ
- TTS: Kokoro/OpenAI ‚úÖ  
- Ducking –¥–ª—è –º–∏–∫—à–∏—Ä–æ–≤–∞–Ω–∏—è ‚úÖ
- –ü—Ä–æ–±–ª–µ–º–∞: –ø—Ä–æ—Ü–µ—Å—Å —É–º–∏—Ä–∞–µ—Ç –Ω–∞ –º–∏–∫—à–∏—Ä–æ–≤–∞–Ω–∏–∏ ‚ùå

### ‚úÖ **–≠—Ç–∞–ø 7: Overlays System**
- –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ–≤–µ—Ä–ª–µ–∏: `OverlayRenderer.ts` ‚ö†Ô∏è
- VHS/Arrow —ç—Ñ—Ñ–µ–∫—Ç—ã: –≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã ‚úÖ
- –°—É–±—Ç–∏—Ç—Ä—ã —á–µ—Ä–µ–∑ Whisper ‚úÖ
- –ü—Ä–æ–±–ª–µ–º–∞: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ ‚ùå

### ‚úÖ **–≠—Ç–∞–ø 8: Effects System**
- VHS 01/02 Effect.mp4 ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
- Arrow Effect.mov ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ  
- Zoom —ç—Ñ—Ñ–µ–∫—Ç—ã ‚Äî —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ
- Timeline overlays ‚Äî —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ

### ‚úÖ **–≠—Ç–∞–ø 9: Error Handling**
- –ù–∞–π–¥–µ–Ω–∞ –û–°–ù–û–í–ù–ê–Ø –ø—Ä–æ–±–ª–µ–º–∞: –Ω–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è FFmpeg –æ—à–∏–±–æ–∫ ‚ùå
- –£–ª—É—á—à–µ–Ω `ffmpeg.ts` —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º ‚úÖ

### ‚úÖ **–≠—Ç–∞–ø 10: –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç** ‚Üê –¢–ï–ö–£–©–ò–ô

---

## üö® **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´**

### üî¥ **–ü–†–û–ë–õ–ï–ú–ê #1: –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ï –≠–ö–†–ê–ù–ò–†–û–í–ê–ù–ò–ï FFMPEG –§–ò–õ–¨–¢–†–û–í**

**–§–∞–π–ª:** `src/pipeline/OverlayRenderer.ts`  
**–°—Ç—Ä–æ–∫–∏:** 150, 156, 163  

**–ë—ã–ª–æ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):**
```typescript
`:enable='between(t,${start},${end})'`
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å (–ü–†–ê–í–ò–õ–¨–ù–û):**
```typescript
`:enable=between(t,${start},${end})`
```

**–°–ª–µ–¥—Å—Ç–≤–∏–µ:** FFmpeg –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π `Missing ')' or too many args in 'between(t'`

**–°–¢–ê–¢–£–°:** ‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –Ω–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

---

### üî¥ **–ü–†–û–ë–õ–ï–ú–ê #2: –û–¢–°–£–¢–°–¢–í–ò–ï –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø FFMPEG –û–®–ò–ë–û–ö**

**–§–∞–π–ª:** `src/utils/ffmpeg.ts`  

**–ë—ã–ª–æ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):**
```typescript
catch (error) {
  log.error("FFmpeg error:", error);
  throw error;
}
```

**–°—Ç–∞–ª–æ (–ò–°–ü–†–ê–í–õ–ï–ù–û):**
```typescript
catch (error: any) {
  log.error("FFmpeg error:", {
    message: error.message,
    stderr: error.stderr,
    stdout: error.stdout,
    cmd: cmd.join(" ")
  });
  throw error;
}
```

**–°–ª–µ–¥—Å—Ç–≤–∏–µ:** –û—à–∏–±–∫–∏ FFmpeg –Ω–µ –≤–∏–¥–Ω—ã –≤ –ª–æ–≥–∞—Ö, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

**–°–¢–ê–¢–£–°:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

### üî¥ **–ü–†–û–ë–õ–ï–ú–ê #3: –î–û–ö–ï–† VOLUMES –ù–ï –ù–ê–î–ï–ñ–ù–´**

**–§–∞–π–ª:** `docker-compose.yml`

**–ü—Ä–æ–±–ª–µ–º–∞:** `/app/output` –Ω–µ –º–∞—É–Ω—Ç–∏—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç –Ω–∞–¥–µ–∂–Ω–æ

**–ü—Ä–æ—è–≤–ª–µ–Ω–∏—è:**
- –í–∏–¥–µ–æ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ —Ö–æ—Å—Ç–µ
- –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `docker cp` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è

**–°–¢–ê–¢–£–°:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ volumes

---

## ‚úÖ **–ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –ò–î–ï–ê–õ–¨–ù–û**

1. **–ë–∞–∑–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ** ‚Äî ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 100%
2. **VHS –∏ Arrow —ç—Ñ—Ñ–µ–∫—Ç—ã** ‚Äî ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ  
3. **–°–ª–∞–π–¥—à–æ—É –∏–∑ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π** ‚Äî ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
4. **API endpoints** ‚Äî ‚úÖ –í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
5. **TTS —Å–∏—Å—Ç–µ–º–∞** ‚Äî ‚úÖ Kokoro –∏ OpenAI –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
6. **FileDownloader** ‚Äî ‚úÖ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ URL —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
7. **Whisper —Å—É–±—Ç–∏—Ç—Ä—ã** ‚Äî ‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

## ‚ö†Ô∏è **–ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –ß–ê–°–¢–ò–ß–ù–û**

1. **–¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ–≤–µ—Ä–ª–µ–∏** ‚Äî ‚ö†Ô∏è –†–∞–±–æ—Ç–∞—é—Ç –Ω–æ —Å –±–∞–≥–∞–º–∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–ú—É–∑—ã–∫–∞** ‚Äî ‚ö†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è  
3. **–ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π** ‚Äî ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –∏–∑-–∑–∞ –±–∞–≥–∞ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üìä **–î–ò–ê–ì–ù–û–°–¢–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø**

### –†–∞–±–æ—á–∏–µ –≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏):
- `basic_test_video.mp4` (880KB) ‚Äî –±–∞–∑–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `overlay_test_video.mp4` (908KB) ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–≤–µ—Ä–ª–µ–∏  
- `effects_test_video.mp4` (656KB) ‚Äî VHS + Arrow —ç—Ñ—Ñ–µ–∫—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- ‚úÖ MediaCreator.enqueue() ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ buildSlidesVideo() ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ VideoOverlayRenderer ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç  
- ‚úÖ AudioMixer ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç (—á–∞—Å—Ç–∏—á–Ω–æ)
- ‚úÖ TTSService ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Whisper ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ùå OverlayRenderer.buildVideoOverlayFilter() ‚Äî –±–∞–≥ —Å –∫–∞–≤—ã—á–∫–∞–º–∏
- ‚ùå runFFmpeg() ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üîß **–ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### üéØ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô):**
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `OverlayRenderer.ts` ‚Üê **–û–°–ù–û–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**
2. –ü–µ—Ä–µ—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π

### üéØ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–ê–ñ–ù–û):**
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ Docker volumes
2. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é JSON –ø–ª–∞–Ω–æ–≤

### üéØ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–ï–õ–ê–¢–ï–õ–¨–ù–û):**
1. –ù–∞–ø–∏—Å–∞—Ç—å –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã –¥–ª—è –ø–∞–π–ø–ª–∞–π–Ω–∞
2. –î–æ–±–∞–≤–∏—Ç—å webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üéâ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï**

### ‚úÖ **–û–°–ù–û–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ô–î–ï–ù–ê –ò –õ–û–ö–ê–õ–ò–ó–û–í–ê–ù–ê**

Media Video Maker ‚Äî **–ö–ê–ß–ï–°–¢–í–ï–ù–ù–´–ô –ü–†–û–ï–ö–¢** —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –Ω–∞ 90% –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

**–ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –°–ï–†–¨–ï–ó–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê** ‚Äî —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –ª–æ–º–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å–±–æ—Ä–∫—É –≤–∏–¥–µ–æ.

### üîÆ **–ü–†–û–ì–ù–û–ó**

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã #1 (—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ FFmpeg —Ñ–∏–ª—å—Ç—Ä–æ–≤):
- **–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ** ‚úÖ
- **–ú—É–∑—ã–∫–∞ + –¢–µ–∫—Å—Ç + –≠—Ñ—Ñ–µ–∫—Ç—ã** –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤–º–µ—Å—Ç–µ ‚úÖ  
- **TTS + –°—É–±—Ç–∏—Ç—Ä—ã + –û–≤–µ—Ä–ª–µ–∏** –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å ‚úÖ
- **–ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π** –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å ‚úÖ

### üìû **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**

**–°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –ü–†–û–î–ê–ö–®–ï–ù–£** –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ –≤ `OverlayRenderer.ts`.

---

**–î–æ–∫–ª–∞–¥ –∑–∞–≤–µ—Ä—à–µ–Ω.** ‚úÖ  
**AI –ú–æ–¥e–ª—å:** Claude Sonnet 4 –æ—Ç Anthropic
